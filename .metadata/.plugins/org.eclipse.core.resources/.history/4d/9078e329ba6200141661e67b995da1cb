package Interfaz;

import java.awt.CardLayout;
import java.awt.Font;
import java.awt.Toolkit;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.WindowEvent;
import java.awt.event.WindowListener;
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileWriter;
import java.io.IOException;

import javax.swing.ImageIcon;
import javax.swing.JButton;
import javax.swing.JComboBox;
import javax.swing.JDialog;
import javax.swing.JFileChooser;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JMenu;
import javax.swing.JMenuBar;
import javax.swing.JMenuItem;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JTextArea;
import javax.swing.JTextField;
import javax.swing.border.TitledBorder;

@SuppressWarnings("serial")
public class Interfaz extends JFrame{
	Sucursal sucursal;
	String principal;
	File file=null;
	
	public Interfaz(){
		super("Hoteles de Centro América");
		setIconImage(Toolkit.getDefaultToolkit().getImage(Interfaz.class.getResource("/resources/logo.png")));
		
		setSize(600, 600);
		setLayout(null);
		setLocationRelativeTo(null);
		
		JMenuBar mBar = new JMenuBar();
		JMenu hotel = new JMenu("Sucursal");
		JMenuItem abrir = new JMenuItem("Abrir Sucursal");
		abrir.addActionListener(new ActionListener(){
			@SuppressWarnings("static-access")
			public void actionPerformed(ActionEvent e){
				JFileChooser fc = new JFileChooser("Seleccione el Archivo");
				if(fc.showOpenDialog(null) != fc.CANCEL_OPTION){
					if(fc.getSelectedFile().getPath().contains(".inicio")){
						file = fc.getSelectedFile();
						sucursal = new Sucursal(file);
					}else{
						errorDeCarga();
					}
				}
			}
		});
		JMenuItem crear = new JMenuItem("Nueva Sucursal");
		crear.addActionListener(new ActionListener(){
			public void actionPerformed(ActionEvent e){
				JFileChooser fc = new JFileChooser();
				String dir="";
				fc.setDialogTitle("Directorio de Destino");
				fc.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);
				fc.setAcceptAllFileFilterUsed(false);
				if(fc.showOpenDialog(null)== JFileChooser.APPROVE_OPTION){
					dir = fc.getSelectedFile().toString();
				}
				String nombre = JOptionPane.showInputDialog("Nombre de la Sucursal","adsf");
				try {
					BufferedWriter bw = new BufferedWriter(new FileWriter(new File(dir+"/"+nombre+".inicio")));
					bw.write("ubicacion:"+JOptionPane.showInputDialog("ubicacion:")+"\r\n");
					bw.write("habitaciones:"+JOptionPane.showInputDialog("Numero de Habitaciones:","552")+"\r\n");
					bw.write("moneda:"+JOptionPane.showInputDialog("moneda")+"\r\n"+
							"cPath:\r\nhPath:\r\npPath:\r\nsPath:\r\n");
					bw.flush();
					bw.close();
				} catch (IOException e1) {
					System.out.print(e1);
				}
				
			}
		});
		JMenuItem salir = new JMenuItem("Salir");
		salir.addActionListener(new ActionListener(){
			public void actionPerformed(ActionEvent e){
				System.exit(0);
			}
		});
		JMenu reportes = new JMenu("Reportes");
		JMenuItem generar = new JMenuItem("Generar");
		
		JMenu promocion = new JMenu("Promocion");
		JMenuItem aLocales = new JMenuItem("Abrir Locales");
		JMenuItem aGlobales = new JMenuItem("Abrir Globales");
		JMenuItem cLocales = new JMenuItem("Crear Locales");
		JMenuItem cGlobales = new JMenuItem("Crear Globales");
		
		hotel.add(abrir);
		hotel.add(crear);
		hotel.addSeparator();
		hotel.add(salir);
		reportes.add(generar);
		promocion.add(aLocales);
		promocion.add(aGlobales);
		promocion.add(cLocales);
		promocion.add(cGlobales);
		mBar.add(hotel);
		mBar.add(reportes);
		mBar.add(promocion);

		JPanel card = new JPanel();
		card.setBorder(null);
		card.setBounds(15, 15, 550, 425);
		card.setLayout(new CardLayout());
		
		//Panel Inicio
		JPanel pInicio=new JPanel();
		pInicio.setLayout(null);
		JLabel logo = new JLabel();
		ImageIcon icon = new ImageIcon();
		icon.setImage(Toolkit.getDefaultToolkit().getImage(Interfaz.class.getResource("/resources/hdc.png")));
		logo.setBounds(0,0,550,425);
		logo.setIcon(icon);
		pInicio.add(logo);
		
		//Panel Check-In
		JPanel pCIn = new JPanel();
		pCIn.setLayout(null);
		
		JLabel lContenedor = new JLabel("HOLA MUNDO");
		lContenedor.setBounds(50,50,100,100);
		pCIn.add(lContenedor);
		
		//Panel Check-Out
		JPanel pCOut = new JPanel();
		pCOut.setLayout(null);
		
		JLabel lNHabitacion = new JLabel("Numero de Habitacion");
		lNHabitacion.setBounds(15, 16, 166, 20);
		pCOut.add(lNHabitacion);
		
		JTextField tNHabitacion = new JTextField();
		tNHabitacion.setBounds(196, 13, 100, 26);
		pCOut.add(tNHabitacion);
		tNHabitacion.setColumns(10);
		
		JLabel lInfo = new JLabel("Informacion del Cliente");
		lInfo.setBounds(15, 88, 166, 20);
		pCOut.add(lInfo);
		
		JTextArea taInfo = new JTextArea();
		taInfo.setBounds(25, 133, 499, 239);
		pCOut.add(taInfo);
		
		JButton bConfirmar = new JButton("Confirmar Check-Out");
		bConfirmar.setBounds(343, 388, 192, 29);
		bConfirmar.addActionListener(new ActionListener(){
			public void actionPerformed(ActionEvent e){
				//verificar el check in
				//halar los datos del cliente
				//quitar reservacion del archivo
			}
		});
		pCOut.add(bConfirmar);
		
		//Fin de cartas
		card.add(pInicio, "pInicio");
		card.add(pCIn,"Check-in");
		card.add(pCOut,"Check-out");
		CardLayout cardLayout = (CardLayout) card.getLayout();
		cardLayout.show(card, "pInicio");
		
		JButton bReserv = new JButton("Reservacion");
		JButton checkIn = new JButton("Check In");
		JButton checkOut = new JButton("Check out");

		checkIn.addActionListener(new ActionListener(){
			public void actionPerformed(ActionEvent e){
				CardLayout cardLayout = (CardLayout) card.getLayout();
				cardLayout.show(card, "Check-in");
			}
		});
		
		checkOut.addActionListener(new ActionListener(){
			public void actionPerformed(ActionEvent e){
				CardLayout cardLayout = (CardLayout) card.getLayout();
				cardLayout.show(card, "Check-out");
			}
		});
		
		bReserv.setBounds(10, getHeight()-115,185,45);
		checkIn.setBounds(205, getHeight()-115,185,45);
		checkOut.setBounds(getWidth()-200, getHeight()-115,185,45);
		
		bReserv.addActionListener(new ActionListener(){
			public void actionPerformed(ActionEvent e){
				setVisible(false);
				reservacion();
			}
		});
		checkIn.addActionListener(new ActionListener(){
			public void actionPerformed(ActionEvent e){
				
			}
		});
		checkOut.addActionListener(new ActionListener(){
			public void actionPerformed(ActionEvent e){
				
			}
		});
		
		add(bReserv); add(checkIn); add(checkOut);
		add(card);
		setJMenuBar(mBar);
		setVisible(true);
	}
	
	public void errorDeCarga(){
		JOptionPane.showMessageDialog(this, "Error al cargar el archivo", "Error", JOptionPane.ERROR_MESSAGE);
	}
	
	@SuppressWarnings({ "rawtypes", "unchecked" })
	private void reservacion(){
		InnerFrame reservacion = new InnerFrame("Reservaciones");
		reservacion.setBounds(0, 0, 600, 700);;
		reservacion.setLayout(null);
		reservacion.setResizable(false);
		reservacion.setLocationRelativeTo(null);
		reservacion.setParent(this);
		Cliente rclient = new Cliente(); 
		
		JLabel lNombre, lPais, lIn ,lOut,lTipoHabitacion, lCHuesped,lPromo,lCosto,lDiaIn,lDiaOut,lMesIn,lMesOut,lAIn,lAOut;
		JTextField tNombre,tCHuesped,tCosto;
		JComboBox cPais, cTipoHabitacion,cPromo,cDiaIn,cDiaOut,cMesIn,cMesOut,cAIn,cAOut;
		JButton bGuardar,bCancelar;
		
		JPanel panel = new JPanel();
		panel.setBorder(new TitledBorder(null, "Formulario de Reservacion", TitledBorder.CENTER, TitledBorder.TOP, null, null));
		panel.setBounds(20, 32, 548, 596);
		getContentPane().add(panel);
		panel.setLayout(null);
		
		lNombre = new JLabel("Nombre y Apellido");
		lNombre.setBounds(36, 31, 133, 20);
		panel.add(lNombre);
		
		tNombre = new JTextField();
		tNombre.setBounds(236, 28, 271, 26);
		panel.add(tNombre);
		tNombre.setColumns(10);
		
		lPais = new JLabel("Pais de Residencia");
		lPais.setBounds(36, 97, 133, 20);
		panel.add(lPais);
		
		String[]pais={"","Africa","Argentina","Asia","Belice","Bolivia", "Brasil","Canada","Chile",
				"Cuba","Colombia","Costa Rica","Ecuador","El Salvador","Estados Unidos","Europa",
				"Guatemala","Honduras","Mexico","Nicaragua","Panama","Paraguay","Peru","Oceania","Uruguay","Venezuela"};
		cPais = new JComboBox(pais);
		cPais.setBounds(236, 94, 271, 26);
		panel.add(cPais);

		lIn = new JLabel("Fecha Check-In");
		lIn.setBounds(36, 163, 135, 20);
		panel.add(lIn);

		lOut = new JLabel("Fecha Check-Out");
		lOut.setBounds(36, 229, 129, 20);
		panel.add(lOut);
		
		Integer[]dia=new Integer[31];
		for(int i=0;i<=30;i++)dia[i]=i+1;
		Integer[]mes=new Integer[12];
		for(int i=0;i<=11;i++)mes[i]=i+1;
		Integer[]aios=new Integer[10];
		int temp=2014;
		for(int i=0;i<=9;i++){aios[i]= temp;temp++;}
		
		lDiaIn = new JLabel("Dia:");
		lDiaIn.setBounds(236, 163, 29, 20);
		panel.add(lDiaIn);
		
		cDiaIn = new JComboBox(dia);
		cDiaIn.setBounds(273, 160, 50, 26);
		panel.add(cDiaIn);
		
		lMesIn = new JLabel("Mes:");
		lMesIn.setBounds(328, 163, 33, 20);
		panel.add(lMesIn);
		
		cMesIn = new JComboBox(mes);
		cMesIn.setBounds(366, 160, 36, 26);
		panel.add(cMesIn);
		
		lAIn = new JLabel("Año:");
		lAIn.setBounds(407, 163, 35, 20);
		panel.add(lAIn);
		
		cAIn = new JComboBox(aios);
		cAIn.setBounds(445, 160, 62, 26);
		panel.add(cAIn);
		
		lDiaOut = new JLabel("Dia:");
		lDiaOut.setBounds(236, 229, 29, 20);
		panel.add(lDiaOut);
		
		cDiaOut = new JComboBox(dia);
		cDiaOut.setBounds(273, 226, 50, 26);
		panel.add(cDiaOut);
		
		lMesOut = new JLabel("Mes:");
		lMesOut.setBounds(328, 229, 33, 20);
		panel.add(lMesOut);
		
		cMesOut = new JComboBox(mes);
		cMesOut.setBounds(366, 226, 36, 26);
		panel.add(cMesOut);
		
		lAOut = new JLabel("Año:");
		lAOut.setBounds(407, 229, 35, 20);
		panel.add(lAOut);
		
		cAOut = new JComboBox(aios);
		cAOut.setBounds(445, 226, 62, 26);
		panel.add(cAOut);
		
		lTipoHabitacion = new JLabel("Tipo de Habitación");
		lTipoHabitacion.setBounds(36, 295, 133, 20);
		panel.add(lTipoHabitacion);
		
		String[]tipo={"","Sencilla","Doble","Suite Delux"};
		cTipoHabitacion = new JComboBox(tipo);
		cTipoHabitacion.setBounds(236, 292, 100, 26);
		panel.add(cTipoHabitacion);
		
		JLabel lCantidadHabitacion = new JLabel("Cantidad:");
		lCantidadHabitacion.setBounds(386, 295, 70,20);
		panel.add(lCantidadHabitacion);
		
		JTextField tCantidad = new JTextField();
		tCantidad.setBounds(445, 292, 62, 26);
		panel.add(tCantidad);
		
		lCHuesped = new JLabel("Cantidad de Huespedes");
		lCHuesped.setBounds(36, 361, 165, 20);
		panel.add(lCHuesped);
		
		tCHuesped = new JTextField();
		tCHuesped.setBounds(236, 358, 271, 26);
		panel.add(tCHuesped);
		tCHuesped.setColumns(10);
		
		//cargar!!
		lPromo = new JLabel("Promoción");
		lPromo.setBounds(36, 422, 76, 20);
		panel.add(lPromo);
		
		cPromo = new JComboBox();
		cPromo.setBounds(236, 419, 271, 26);
		panel.add(cPromo);

		lCosto = new JLabel("Costo");
		lCosto.setBounds(36, 488, 40, 20);
		panel.add(lCosto);
		
		tCosto = new JTextField();
		tCosto.setText("$ -");
		tCosto.setFont(new Font("Tahoma", Font.BOLD, 20));
		tCosto.setEditable(false);
		tCosto.setBounds(236, 485, 271, 26);
		panel.add(tCosto);
		
		bCancelar = new JButton("Cancelar");
		bCancelar.setIcon(new ImageIcon(Interfaz.class.getResource("/resources/e.png")));
		bCancelar.setBounds(36, 527, 196, 60);
		bCancelar.addActionListener(new ActionListener(){
			public void actionPerformed(ActionEvent e){
				reservacion.promt();
			}
		});
		panel.add(bCancelar);

		bGuardar = new JButton("Guardar");
		bGuardar.setIcon(new ImageIcon(Interfaz.class.getResource("/resources/g.png")));
		bGuardar.setBounds(311, 527, 196, 60);
		bGuardar.addActionListener(new ActionListener(){
			public void actionPerformed(ActionEvent e){
				rclient.nombre = tNombre.getText();
				rclient.paisResidencia=cPais.getSelectedItem().toString();
				int fechaI = Integer.parseInt(cDiaIn.getSelectedItem().toString());
				int fechaF = Integer.parseInt(cDiaIn.getSelectedItem().toString());
				System.out.println(rclient.paisResidencia);
				JDialog guardar = new JDialog(reservacion,"Guardar?");
				guardar.setBounds(0,0,250,250);
				guardar.setResizable(false);
				guardar.setLocationRelativeTo(null);
				guardar.setLayout(null);
				
				JTextArea display = new JTextArea();
				display.setBounds(7,15,143,179);
				display.setEditable(false);
				display.setAutoscrolls(true);
				guardar.add(display);
				
				JButton ok = new JButton("OK");
				ok.setBounds(157,85,80,50);
				ok.addActionListener(new ActionListener(){
					public void actionPerformed(ActionEvent e){
						
					}
				});
				
				guardar.add(ok);
				guardar.setDefaultCloseOperation(JDialog.DISPOSE_ON_CLOSE);
				guardar.setVisible(true);
			}
		});
		panel.add(bGuardar);
		
		reservacion.getContentPane().add(panel);
		reservacion.setVisible(true);
		reservacion.setDefaultCloseOperation(JFrame.DO_NOTHING_ON_CLOSE);
	}
	
	private void servicios(){
		
	}
	
	private void busqueda(){
		
	}
	
	private void promociones(){
		
	}

	private void reportes(){
		
	}
	
	public class InnerFrame extends JFrame{
		JFrame parent = null;
		//JFrame thisFrame = this;
		public InnerFrame(String title){
			setTitle(title);
			addWindowListener(new WindowListener(){
				
				public void windowActivated(WindowEvent arg0) {
					
				}
				
				public void windowClosed(WindowEvent arg0) {
					
				}
				
				public void windowClosing(WindowEvent arg0) {
					promt();
				}
				
				public void windowDeactivated(WindowEvent arg0) {
					
				}
				
				public void windowDeiconified(WindowEvent arg0) {
					
				}
				
				public void windowIconified(WindowEvent arg0) {
					
				}
				
				public void windowOpened(WindowEvent arg0) {
					
				}
				
			});
		}
		public void setParent(JFrame parent){
			this.parent = parent;
			this.setIconImage(parent.getIconImage());
		}
		
		public void promt(){
			int result= JOptionPane.showConfirmDialog(this,"Seguro que quieres salir?","Seguro?",JOptionPane.ERROR_MESSAGE);
			if(result == JOptionPane.YES_OPTION){
				this.dispose();
				parent.setVisible(true);
			}else{
				System.out.println("No pasa nada.");
			}
		}
	}
	
	public static void main(String args[]){
		Interfaz inter = new Interfaz();
		inter.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
		inter.setResizable(false);
	}
}
